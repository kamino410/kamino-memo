# 単体法（シンプレックス法：simplex method）

## 概要

線形計画問題は

1. 実行可能基底解を1つ見つける
1. 「見つけた実行可能基底解より目的関数値が小さくなる実行可能基底解を探す」を繰り返す

というアルゴリズムによって最適解を求めることができる。
シンプレックス法は2番の手順を効率よく実現した解法である。

## 原理

理論を追いやすくするため、記号の置き換えは最小限に留めて解説する。

次のような線形計画問題について考える。

$$
\begin{eqnarray}
minimize : &\ & c_B^Tx_B + c_N^Tx_N \\
s.t. &\ &
\begin{cases}
Bx_B + Nx_N=b\\
x_B, x_N \geq 0
\end{cases}
\end{eqnarray}
$$

このとき双対問題は

$$
\begin{eqnarray}
minimize :&\ & b^Ty \\
s.t. &\ &
\begin{cases}
B^Ty + z_B=c_B \\
N^Ty + z_N=c_N \\
z_B, z_N \geq 0
\end{cases}
\end{eqnarray}
$$

のように表される。

この問題について、なんらかの方法で実行可能基底解 $$x^* = \begin{bmatrix}x_B \\ x_N\end{bmatrix} = \begin{bmatrix}B^{-1}b \\ 0\end{bmatrix} \geq 0$$ が1つ得られているものとする。

### 最適解であるかの検証

まず、現在の解が最適解であるかを確認する。

$$x^* $$が最適解であると仮定すると双対定理より $$c^Tx^* = b^Ty$$ が成立するため、

$$
y=(B^T)^{-1}c_B, \ \ \ z_B=0, \ \ \ z_N = c_N - N^T (B^T)^{-1}c_B
$$

となる。

もし $$z_N \ngeq 0$$ ならば、双対問題が実行不可能な解を持っていることになるため双対定理が満たされず、$$x^* $$が最適解であるという仮定は成り立たない。

逆に $$z_N \geq 0$$ ならば、双対問題も同じ評価値の実行可能解を持ち、双対定理を満たすため、$$x^* $$は最適解であることがわかるためここで終了する。

### 基底変数に取り込む非基底変数を選択

最適解でなかった場合、$$z_N$$の負の要素の中から値が最小である$$(z_N)_ q$$を基底変数に取り込むことにする（負の要素ならどれを選んでも良いが、最適値に早めに近づきそうなものを選ぶ）。

$$
(z_N)_ q = \min\{(z_N)_ k \ | \ (z_N)_ k < 0, \ 0 \leq k \leq n-m\}
$$

この$$q$$に合わせて問題を基底形式で表現する。

$$
\begin{eqnarray}
minimize :&\ & c_B^T B^{-1}b + (z_N)_ qx_q \\
s.t.&\ &
x_B = B^{-1}b - B^{-1}N_qx_q
\end{eqnarray}
$$

ただし$$N_q$$は$$N$$の$$x_q$$に対応する列ベクトルを示す。

### 問題が有界であるかの検証

もし $$-B^{-1}N_q \geq 0$$ であれば、ある$$(x_B)_ k$$と$$x_q$$をともに大きくすることで制約条件を満たしながら評価値を無限に小さくできる。この場合は解が有界でないという結論が得られるためここで終了する。

### 基底変数の入れ替え

$$(-B^{-1}N)_ {kq} < 0$$ となる要素がある場合、制約条件のもとで、$$x_ k$$を小さく、$$x_q$$を大きくしていけば評価値は小さくなるはずである。$$x\geq0$$ の制約条件を考慮すると、結局は1つの基底変数$$x_p$$を外し（$$x_p : \alpha \rightarrow 0$$）、かわりに非基底変数$$x_q$$を基底変数に加えればよいことになる（$$x_q : 0 \rightarrow \beta$$）。

制約条件 $$x_B = B^{-1}b - B^{-1}N_qx_q$$ を考慮すると、$$x_q$$が取りうる最大値$$\beta$$は

$$
\beta = \frac{(B^{-1}b)_ p}{(-B^{-1}N)_ {pq}} = \min_{(-B^{-1}N)_ {iq} < 0} \frac{(B^{-1}b)_ i}{(-B^{-1}N)_ {iq}}
$$

となる。

以上から新しい基底変数$$x_B^* $$と非基底変数$$x_B^* $$が求まり、評価値がより小さい実行可能基底解が得られる。
