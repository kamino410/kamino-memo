# 単体法（シンプレックス法：simplex method）

## 概要

線形計画問題は

1. 実行可能基底解を1つ見つける
1. 「見つけた実行可能基底解より目的関数値が小さくなる実行可能基底解を探す」を繰り返す

というアルゴリズムによって最適解を求めることができる。
シンプレックス法は2番の手順を効率よく実現した解法である。

## 事前知識：基底形式（basic form）

$$x$$を基底解、つまり $$x = \begin{bmatrix}x_B \\ x_N\end{bmatrix} = \begin{bmatrix}B^{-1}b \\ 0\end{bmatrix}$$ とする。

ここでLP問題の標準形を以下のように表す。

$$
\begin{eqnarray}
w &=& \begin{bmatrix} c_B^T & c_N^T \end{bmatrix} \begin{bmatrix} x_B \\ x_N \end{bmatrix} \\
b &=& \begin{bmatrix} B & N \end{bmatrix} \begin{bmatrix} x_B \\ x_N \end{bmatrix}
\end{eqnarray} \tag{1}
$$

$$B$$に逆行列が存在するという性質を利用してこの式を変形すると次のようになる。

$$
\begin{eqnarray}
\omega &=& c_B^T B^{-1}b + (c_N^T-c_B^TB^{-1}N)x_N \\
B^{-1}b &=& x_B + B^{-1}Nx_N
\end{eqnarray} \tag{2}
$$

この式を **基底形式（basic form）** といい、$$\bar{c}_N^T = c_N^T-c_B^TB^{-1}N$$ を **相対費用係数** という。

## 原理

事前に実行可能基底解 $$x = \begin{bmatrix}x_B \\ x_N\end{bmatrix} = \begin{bmatrix}B^{-1}b \\ 0\end{bmatrix} \geq 0$$ が得られているものとする。

まず、現在の解が最適解であるかを確認する。

現在の評価値は式(2)より

$$
\omega = c_B^T B^{-1}b + \bar{c}_N^Tx_N
$$

である。ここで、基底変数の選び方を変えることを考える。

$$\bar{c}_N\geq 0$$であれば非基底変数をどのように変更しても評価値は減少しないため、現在の解が最適解であることがわかる。

逆にある要素$$(\bar{c}_N)_ k$$ が負値であれば $$(x_N)_ k = \theta$$ が非零な値を取ることによって評価値をより小さくできる可能性がある。そこで制約条件を満たしながら$$(x_N)_ k$$をなるべく大きくすることを考える。

もし列ベクトル $$N_ k \leq 0$$ であれば制約条件を満たしながら無限に評価値を小さくできるため、有界でないという結論が出る。

逆に正の値を取る要素$$N_ {k,i}$$があれば$$\theta$$の取り方に対して

$$
\theta \leq \min\{ \bar{b}_i / N_ {i,k} \ | \ N_ {i,k} > 0 , 1 \leq i \leq m\}
$$

という制約がかかる。よって $$\bar{b}_i / (B_N)_ {k,i}$$ が最も小さくなるような$$i$$を見つけ、$$(x_B)_ i$$を基底変数から除き$$(x_N)_ k$$を基底変数に追加すれば評価値がより小さい実行可能基底解が得られる。

## 手順

1. 何らかの方法で実行可能基底解を1つ見つける
1. 相対費用係数$$\bar{c}_N$$を計算する
   * $$\bar{c}_N\geq 0$$なら最適解を得たため終了する
   * そうでなければ最小の要素$$(\bar{c}_N)_ k$$を見つける
1. 列ベクトル$$N_k$$に注目する
   * $$N_k\leq 0$$なら目的関数が下に有界でないため終了する
   * $$N_{i,k}>0$$となる成分が存在するなら$$\frac{(b_N)_ i}{N_{i,k}}$$が最小となる行を見つける
1. $$N_{i,k}$$をピボットとする掃き出しを行い、$$(x_B)_ i$$の代わりに$$(x_N)_ k$$を基底変数に加える
1. 2~3を繰り返す
