# 双対問題（dual problem）

## 定義

標準形の線形計画問題を主問題として

$$
\begin{eqnarray}
minimize : &\ & b^Ty \\
s.t. &\ &
A^Ty \leq c
\end{eqnarray}
$$

もしくは

$$
\begin{eqnarray}
maximize : &\ & b^Ty \\
s.t.&\ &
\begin{cases}
A^Ty + z = c \\
z \geq 0
\end{cases}
\end{eqnarray}
$$

で表される問題を**双対問題**という。
また、このときの変数 $$y,z$$ は**双対変数**という。
主問題と双対問題の間には次のような関連性がある。

## 弱双対定理

$$\bar{x}$$ と $$\bar{y}$$ がそれぞれ主問題と双対問題の実行可能解であるならば

$$
c^T\bar{x} \geq b^T\bar{y}
$$

が成立する。

### 証明

$$
c^Tx = (A^Ty + z)^Tx = y^T Ax + z^Tx = y^Tb + z^Tx = b^Ty + z^Tx
$$

実行可能なら $$z \geq 0$$ となるため $$c^T\bar{x} \geq b^T\bar{y}$$

## 双対定理

1. 主問題が実行可能解を持ち最適値 $$f$$ をとる　⇔　双対問題が実行可能解を持ち最適値 $$f$$ をとる
1. 主問題の最適解に対して、双対問題の最適解はそれに対応する単体乗数 $$(B^{-1})^Tc_Bb$$ となる

### 証明

主問題の最適解 $$x^*$$ は弱双対定理を満たす最小の値であるはずなので、

$$
c^T x^* = \max \{ b^T y\}
$$

右辺は双対問題の最適解に他ならないため、

$$
c^T x^* = b^T y^*
$$

が成立することがわかる。

この式を基底解と非基底解に分割して考えると、

$$
\begin{eqnarray}
c_B^T x_B + c_N^T x_N &=& b^Ty \\
c_B^T B^{-1}b &=& b^Ty \\
y &=& (B^{-1})^Tc_Bb
\end{eqnarray}
$$

となる（$$*$$ は省略）。

## まとめ

上記の定理の他に主問題・双対問題の性質を加えまとめると以下のようになる。

1. 主問題・双対問題がともに実行可能解を持つならそれは各々の最適解であり、その最適値は一致する
    * 双対問題の最適解は主問題の最適解に対応する単体乗数
2. 主問題が実行可能で非有界　⇔　双対問題は実行不可能
3. 主問題が実行不可能　⇔　双対問題は実行可能だが非有界
