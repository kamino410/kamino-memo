# ナイキストの安定判別法（Nyquist）

[フィードバック制御系の安定性](stability_of_feedback.md)で述べた通り、フィードバック制御系の内部安定性の判別には特性多項式の根を調べれば良い。
しかし特性多項式が高次である場合は、ラウス＝フルビッツの安定判別法の適用にさえ非常に手間がかかる。

そこで、特性多項式を直接計算するのではなく、開ループ伝達関数の周波数応答に基いて図的に安定性を判別する方法として考案されたのが**ナイキストの安定判別法**である。

ナイキストの安定判別法は、実測可能なフィードフォワード制御系の周波数伝達関数 $$P(j\omega)K(j\omega)$$ の[ベクトル軌跡](vector_locus.md)からフィードバック制御系の安定性を判別できる点で優れている。

また、むだ時間を含む系にも適用できることが知られている。

## 手順

1. 開ループ伝達関数（一巡伝達関数）$$P(s)K(s)$$ の極の中で実部が正であるものの個数を調べ、これを $$\Pi$$ とする。
2. 開ループ伝達関数のベクトル軌跡 $$P(j\omega)K(j\omega)$$ を各周波数 $$\omega = 0 \sim \infty$$ の範囲で描く。さらにこれを実軸に関して上下対象に描き、**ナイキスト軌跡** $$\Gamma$$ を得る。
3. ナイキスト軌跡 $$\Gamma$$ が点 $$(-1,0)$$ の周りを時計方向にまわる回数（反時計方向は負として数える）を調べ、これを $$N$$ とする。
4. 閉ループ系の不安定な極の数は $$Z=N+\Pi$$ となる。したがって、$$Z=0$$ であればフィードバック制御系は安定、$$Z\neq0$$ であれば不安定である。

----

また、開ループ伝達関数が安定（ $$\Pi=0$$ ）であることがわかっているとき、$$N=0$$ かの検証だけになるため、次のように手順を簡略化できる。

1. 開ループ伝達関数 $$P(s)K(s)$$ の極の実部がすべて負であることを確認する。
2. 開ループ伝達関数のベクトル軌跡 $$P(j\omega)K(j\omega)$$ を各周波数 $$\omega = 0 \sim \infty$$ の範囲で描く。
3. $$\omega = 0 \rightarrow \infty$$ と辿ったとき、ベクトル軌跡が点 $$(-1,0)$$ を常に左に見て動くならフィードバック制御系は安定、右に見て動くなら不安定である。

## 解説

$$P(s) = \frac{D_P(s)}{N_P(s)}, \ \ \ K(s) = \frac{D_K(s)}{N_K(s)}$$ とする。一巡伝達関数 $$P(j \omega)K(j \omega)$$ を用いて、

$$
\begin{eqnarray}
w = 1+P(s)K(s) &=& \frac{N_P(s)N_K(s)+D_P(s)D_K(s)}{N_P(s)N_K(s)} \\
&=& \frac{(s-r_1)(s-r_2)\cdots(s-r_n)}{(s-p_1)(s-p_2)\cdots(s-p_n)}
\end{eqnarray}
$$

よって $$w$$ は系全体の極 $$r_i$$ と、開ループ系の極 $$p_i$$ によって表されることがわかる。

$$w$$ の偏角について考えると、

$$
\angle w = \sum_{i=1}^n \angle (s-r_i) - \sum_{i=1}^n \angle (s-p_i)
$$

である。

ここで複素平面上を 原点 → $$+\infty j$$ → $$+\infty$$ → $$-\infty j$$ → 原点 と辿る閉曲線 $$C$$ を考える。
ある極 $$q$$ が不安定極である場合、$$q$$ の実部は正であるため閉曲線 $$C$$ の内側に存在するはずである。

$$s$$ が閉曲線 $$C$$ を辿りながら一周したとき、もし $$q$$ が閉曲線 $$C$$ の内側にあれば $$\angle(s-q)$$ の総変化量は $$-360^\circ$$ となり、閉曲線 $$C$$ の外側にあれば $$\angle (s-q)$$ の総変化量は $$0^\circ$$ となる。

よって右辺は $$-360^\circ \times Z + 360^\circ \times \Pi$$ とわかる。

また同じく $$s$$ が閉曲線 $$C$$ を辿りながら一周したときの $$w - 1 = P(s)K(s)$$ の軌跡は、

1. 原点 → $$\infty j$$ のとき
    * $$P(s)K(s) \ \ \ (\omega = 0 \sim +\infty)$$ のベクトル軌跡と一致
2. $$+\infty j$$ → $$+\infty$$ → $$-\infty j$$ のとき
    * $$P(\infty)K(\infty) = 0$$ （プロパー性より）
3. $$-\infty j$$ → 原点 のとき
    * $$P(s)K(s) \ \ \ (\omega = -\infty \sim 0)$$ のベクトル軌跡と一致
    * つまり $$P(s)K(s) \ \ \ (\omega = 0 \sim +\infty)$$ のベクトル軌跡と実軸について対象な軌跡

となるため、上記のようなナイキスト軌跡に一致することがわかる。
よって左辺は $$\angle w$$ の総変化量 $$= -360^\circ \times N$$ である。

以上より

$$
\begin{eqnarray}
-N &=& -Z + \Pi \\
Z &=& N + \Pi
\end{eqnarray}
$$

が得られ、閉ループ系の不安定極の個数 $$Z$$ が計算できる。
