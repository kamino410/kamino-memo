# 状態方程式（State-space Equation）

## 定義

システムを入力・出力・内部状態を表現する**状態変数**の関係で記述した連立方程式を**状態方程式**という。
なお、熱力学における気体の状態方程式とはまったく別物である。

一般に $$m$$ 入力 $$r$$ 出力の $$n$$ 次元システムの状態方程式は

$$
\begin{eqnarray}
\dot{x} &=& f(x,u) \\
y &=& g(x,u)
\end{eqnarray}
$$

と表される。ただし $$x$$, $$y$$, $$u$$ はそれぞれ $$n$$, $$m$$, $$r$$ 次元のベクトル、$$\dot{x}$$ はベクトル $$x$$ の微分である。

線形システムの場合、関数 $$f$$, $$g$$ は行列演算によって表現できる。

$$
\begin{eqnarray}
\dot{x} &=& Ax + Bu \\
y &=& Cx + Du
\end{eqnarray}
$$

ただし $$A$$, $$B$$, $$C$$, $$D$$ はそれぞれ $$n \times n$$, $$n \times m$$, $$r \times n$$, $$r \times m$$ の定数行列である。

一般的なシステムでは入出力の間に何らかの動特性があることがほとんどのため、入出力直達項は考慮されないことが多い。そこで現代制御理論においては $$D=0$$ とした線形状態方程式を考えるのが一般的である。

$$
\begin{eqnarray}
\dot{x} &=& Ax + Bu \\
y &=& Cx
\end{eqnarray}
$$

## 時変システムの状態方程式

時刻 $$t$$ に依存してシステムの特性が変化するようなシステムを**時変システム**という。

### 一般的な時変システム

$$
\begin{eqnarray}
\dot{x} &=& f(x,u,t) \\
y &=& g(x,t)
\end{eqnarray}
$$

### 線形時変システム

$$
\begin{eqnarray}
\dot{x} &=& A(t)x + B(t)u \\
y &=& C(t)x
\end{eqnarray}
$$

## 状態方程式と伝達関数

伝達関数は入出力の関係だけに注目している一方、状態方程式は $$n$$ 次の状態変数を考慮する。
そのため**伝達関数表現が同じになるような異なる状態方程式が存在する**。
言い換えると伝達関数は状態方程式を縮小した概念である。

また、伝達関数は主に1入力1出力について論じられる一方、状態方程式では $$m$$ 入力 $$r$$ 出力を扱う。

## 状態方程式の解

$$ \dot{x} = ax + b $$ の解は $$e^{at}$$ を用いて次のように表されることが知られている。

$$
x(t) = e^{a(t-t_0)}x(t_0) + \int_{t_0}^t e^{a(t-\tau)} b u(\tau) d\tau
$$

また、$$e^{at}$$ はテイラー展開を利用して次のように表される。

$$
e^{at} = a + at + \frac{a^2t^2}{2!} + \frac{a^3t^3}{3!} + \cdots
$$

ここで $$a$$ を行列に拡張することを考えて

$$
e^{At} = A + At + \frac{A^2t^2}{2!} + \frac{A^3t^3}{3!} + \cdots
$$

と定義すると、次のような演算について $$e^{at}$$ と同じ形で表されることが確認できる。

$$
\begin{eqnarray}
&\ & \frac{d(e^{At})}{dt} = Ae^{At} = e^{At}A \\
&\ & e^{A(t_1+t_2)} = e^{At_1}e^{At_2} \\
&\ & (e^{At})^{-1} = e^{-At} \\
&\ & e^{At}|_{t=0} = I
\end{eqnarray}
$$

（ただし、$$e^{(A+B)t} = e^{At}e^{Bt}$$ は $$AB=BA$$ のときにしか成立しないなど、すべての演算が同じ形になるわけではない）

上記の変形を用いれば $$\dot{x} = Ax + B$$ の解は $$e^{at}$$ の場合と同じ形で表される。

$$
x(t) = e^{A(t-t_0)}x(t_0) + \int_{t_0}^t e^{A(t-\tau)} B u(\tau) d\tau
$$
